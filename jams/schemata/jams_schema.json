{
    "$schema": "http://json-schema.org/draft-04/schema#",

    "definitions": {

        "FileMetadata": {
            "type": "object",
            "title": "File Metadata",
            "properties": {
                "identifiers": {
                    "type": "object",
                    "title": "Namespace Identifiers",
                    "description": "Sandbox for file ID information (e.g. echonest ID, musicbrainz ID, etc.)."
                },
                "artist": { "type": "string"},
                "title": { "type": "string"},
                "release": { "type": "string"},
                "duration": { "type": "number", "minimum": 0.0},
                "jams_version" : { "type": "string", "pattern": "[0-9].[0-9].[0-9]"}
            }
        },

        "Curator": {
            "type": "object",
            "title": "Curator",
            "description": "Curator contact information: name and email",
            "properties": {
                "name": { "type": "string"},
                "email": { "type": "string", "format": "email" }
            },
            "required": ["name", "email"]
        },

        "AnnotationMetadata": {
            "type": "object",
            "title": "Annotation metadata",
            "description": "All metadata required to describe an annotation",
            "properties": {
                "corpus": { "type": "string" },
                "version": { "type": ["string", "number"] },
                "curator": { "$ref": "#/definitions/Curator" },
                "annotator": {
                    "type": "object",
                    "title": "Annotator",
                    "description": "Sandbox for information about the annotator."
                },
                "annotation_tools": { "type": "string"},
                "annotation_rules": { "type": "string"},
                "validation": { "type": "string"},
                "data_source": { "type": "string"}
            }
        },

        "Annotation": {
            "id": "#annotation",
            "type": "object",
            "title": "Annotation",
            "description": "An annotation of a single observation, e.g. tags",
            "properties": {
                "annotation_metadata": { "$ref": "#/definitions/AnnotationMetadata" },
                "data": {
                    "title": "Data",
                    "description": "An array of observations",
                    "type": "array",
                    "items": {
                        "oneOf": [  { "$ref": "observations.json#/definitions/DenseObservation" },
                                    { "$ref": "observations.json#/definitions/SparseObservation" } ]
                    }
                },
                "namespace": {"type": "string"},
                "sandbox": { "type": "object"},
                "time": {
                    "oneOf": [ {"type": "number", "minimum": 0.0},
                               {"type": "null"} ]
                },
                "duration": {
                    "oneOf": [ {"type": "number", "minimum": 0.0},
                               {"type": "null"} ]
                }
            },
            "required": ["annotation_metadata", "data", "namespace"],
            "oneOf" : [
                { "$ref" : "namespaces/beat/beat.json#" },
                { "$ref" : "namespaces/beat/position.json#" },
                { "$ref" : "namespaces/chord/chord.json#" },
                { "$ref" : "namespaces/chord/harte.json#" },
                { "$ref" : "namespaces/chord/roman.json#" },
                { "$ref" : "namespaces/key/key_mode.json#" },
                { "$ref" : "namespaces/lyrics/bow.json#" },
                { "$ref" : "namespaces/lyrics/lyrics.json#" },
                { "$ref" : "namespaces/misc/blob.json#" },
                { "$ref" : "namespaces/misc/scaper.json#" },
                { "$ref" : "namespaces/misc/vector.json#" },
                { "$ref" : "namespaces/mood/thayer.json#" },
                { "$ref" : "namespaces/onset/onset.json#" },
                { "$ref" : "namespaces/pattern/jku.json#" },
                { "$ref" : "namespaces/pitch/class.json#" },
                { "$ref" : "namespaces/pitch/contour_hz.json#" },
                { "$ref" : "namespaces/pitch/hz.json#" },
                { "$ref" : "namespaces/pitch/midi.json#" },
                { "$ref" : "namespaces/pitch/note_hz.json#" },
                { "$ref" : "namespaces/pitch/note_midi.json#" },
                { "$ref" : "namespaces/segment/multi.json#" },
                { "$ref" : "namespaces/segment/open.json#" },
                { "$ref" : "namespaces/segment/salami_function.json#" },
                { "$ref" : "namespaces/segment/salami_lower.json#" },
                { "$ref" : "namespaces/segment/salami_upper.json#" },
                { "$ref" : "namespaces/segment/tut.json#" },
                { "$ref" : "namespaces/tag/cal10k.json#" },
                { "$ref" : "namespaces/tag/cal500.json#" },
                { "$ref" : "namespaces/tag/gtzan.json#" },
                { "$ref" : "namespaces/tag/medleydb_instruments.json#" },
                { "$ref" : "namespaces/tag/msd_tagtraum_cd1.json#" },
                { "$ref" : "namespaces/tag/msd_tagtraum_cd2.json#" },
                { "$ref" : "namespaces/tag/open.json#" },
                { "$ref" : "namespaces/tag/tag_audioset_genre.json#" },
                { "$ref" : "namespaces/tag/tag_audioset_instruments.json#" },
                { "$ref" : "namespaces/tag/tag_audioset.json#" },
                { "$ref" : "namespaces/tag/tag_fma_genre.json#" },
                { "$ref" : "namespaces/tag/tag_fma_subgenre.json#" },
                { "$ref" : "namespaces/tag/tag_urbansound.json#" },
                { "$ref" : "namespaces/tempo/tempo.json#" }
            ]
        }

    },

    "type": "object",
    "title": "JAMS file",
    "description": "JSON Annotated Music Specification",
    "properties": {

        "file_metadata": { "$ref": "#/definitions/FileMetadata" },

        "annotations": {
            "type": "array",
            "title": "Annotations",
            "description": "Array of annotations",
            "items": { "$ref": "#/definitions/Annotation" }
        },

        "sandbox": { "type": "object" }
    }
}
